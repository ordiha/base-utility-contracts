<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base Utility Tools</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.2/dist/web3.min.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            color: #fff;
            background: url('https://i.imgur.com/0aiXwgk.jpeg') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .container {
            background: rgba(0, 0, 0, 0.7);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 900px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        h1 {
            color: #d4a017;
            text-align: center;
            margin-bottom: 25px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px #000;
        }
        .section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            backdrop-filter: blur(5px);
        }
        button {
            background-color: #d4a017;
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #b8860b;
        }
        p {
            margin: 5px 0;
            font-size: 1em;
        }
        input {
            padding: 8px;
            margin: 5px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border: 1px solid #d4a017;
        }
        select {
            padding: 8px;
            margin: 5px;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border: 1px solid #d4a017;
        }
        #status {
            color: #ff4444;
            font-weight: bold;
            text-align: center;
            word-wrap: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Base Utility Tools</h1>

        <div class="section">
            <h2>SimpleTimer</h2>
            <button onclick="resetTimer()">Reset Timer</button>
            <p>Time Left: <span id="timerStatus"></span> seconds</p>
        </div>

        <div class="section">
            <h2>TipJar</h2>
            <button onclick="tip()">Tip</button>
            <p>Total Tips: <span id="tipAmount"></span> wei</p>
        </div>

        <div class="section">
            <h2>VotePoll</h2>
            <select id="voteOption">
                <option value="true">Yes</option>
                <option value="false">No</option>
            </select>
            <button onclick="votePoll()">Vote</button>
            <p>Results: Yes <span id="yesVotes"></span>, No <span id="noVotes"></span></p>
        </div>

        <div class="section">
            <h2>GiveawayBox</h2>
            <button onclick="claimGiveaway()">Claim Giveaway</button>
            <p>Claim Amount: <span id="claimAmount"></span> wei</p>
        </div>

        <div class="section">
            <h2>MessageBoard</h2>
            <input type="text" id="messageInput" placeholder="Enter message">
            <button onclick="setMessage()">Set Message</button>
            <p>Last Message: <span id="lastMessage"></span></p>
        </div>

        <div class="section">
            <h2>Counter</h2>
            <button onclick="incrementCounter()">Increment</button>
            <p>Count: <span id="counterValue"></span></p>
        </div>

        <div class="section">
            <h2>Storageunit</h2>
            <input type="text" id="storeInput" placeholder="Data to store">
            <button onclick="storeData()">Store</button>
            <p>Stored Data: <span id="storedData"></span></p>
        </div>

        <div class="section">
            <h2>Randompicker</h2>
            <button onclick="pickRandom()">Pick Random</button>
            <p>Random Value: <span id="randomValue"></span></p>
        </div>

        <div class="section">
            <h2>Greetingcard</h2>
            <input type="text" id="greetingInput" placeholder="Enter greeting">
            <button onclick="sendGreeting()">Send Greeting</button>
            <p>Last Greeting: <span id="lastGreeting"></span></p>
        </div>

        <div class="section">
            <h2>Tokentracker</h2>
            <input type="text" id="tokenAddress" placeholder="Enter token address">
            <button onclick="trackToken()">Track Token</button>
            <p>Token Balance: <span id="tokenBalance"></span></p>
        </div>

        <div class="section">
            <h2>EventTracker</h2>
            <button onclick="trackEvent()">Track Event</button>
            <p>Last Event: <span id="lastTrackedEvent"></span></p>
        </div>

        <div class="section">
            <h2>PriceChecker</h2>
            <button onclick="checkPrice()">Check Price</button>
            <p>Current Price: <span id="currentPrice"></span> ETH</p>
        </div>

        <div class="section">
            <h2>TodoList</h2>
            <input type="text" id="todoInput" placeholder="Enter task">
            <button onclick="addTask()">Add Task</button>
            <p>Last Task: <span id="lastTask"></span></p>
        </div>

        <div class="section">
            <h2>Scoreboard</h2>
            <button onclick="addScore()">Add Score</button>
            <p>Your Score: <span id="yourScore"></span></p>
        </div>

        <div class="section">
            <h2>FeedbackBox</h2>
            <input type="text" id="feedbackInput" placeholder="Enter feedback">
            <button onclick="sendFeedback()">Send Feedback</button>
            <p>Last Feedback: <span id="lastFeedback"></span></p>
        </div>

        <div class="section">
            <h2>WishList</h2>
            <input type="text" id="wishInput" placeholder="Enter wish">
            <button onclick="addWish()">Add Wish</button>
            <p>Last Wish: <span id="lastWish"></span></p>
        </div>

        <div class="section">
            <h2>QuizGame</h2>
            <button onclick="submitAnswer()">Submit Answer</button>
            <p>Score: <span id="quizScore"></span></p>
        </div>

        <div class="section">
            <h2>DonationPool</h2>
            <button onclick="donate()">Donate (0.001 ETH)</button>
            <button onclick="withdrawDonation()" disabled id="withdrawBtn">Withdraw</button>
            <p>Total Donated: <span id="totalDonated"></span> wei</p>
        </div>

        <div class="section">
            <h2>ProfileBadge</h2>
            <button onclick="claimBadge()">Claim Badge</button>
            <p>Badge Status: <span id="badgeStatus"></span></p>
        </div>

        <div class="section">
            <h2>PollResultsViewer</h2>
            <button onclick="updatePollResultsViewer()">Update Results</button>
            <p>Total Votes (Poll 0): <span id="totalVotes"></span></p>
        </div>

        <div class="section">
            <h2>EventReminder</h2>
            <button onclick="setReminder()">Set Reminder (Event 0)</button>
            <p>Last Event: <span id="lastEvent"></span></p>
        </div>

        <div class="section">
            <h2>FeedbackCollector</h2>
            <input type="text" id="feedbackInputNew" placeholder="Enter feedback">
            <button onclick="submitFeedback()">Submit Feedback</button>
            <p>Feedback Count: <span id="feedbackCount"></span></p>
        </div>

        <div class="section">
            <h2>RewardTracker</h2>
            <button onclick="addReward()">Add Reward (1)</button>
            <p>Your Reward: <span id="yourReward"></span></p>
        </div>

        <div class="section">
            <h2>EventLogger</h2>
            <input type="text" id="logInput" placeholder="Enter log">
            <button onclick="recordLog()">Record Log</button>
            <p>Log Count: <span id="logCount"></span></p>
        </div>

        <p id="status"></p>
    </div>

    <script>
        const web3 = new Web3(window.ethereum || 'https://mainnet.base.org');
        const addresses = {
            simpleTimer: '0xC1949249093af2d0aaB8a2D2B241e0B828171DE7',
            tipJar: '0x62A3536df479317Bd76480F801278867dB1603Ff',
            votePoll: '0xCb8A9D3E1Bd3Ea1793DED3373CA1CAc1969766A1',
            giveawayBox: '0xea23EC1b0fF0316D8FeD21f26E86aF422fbd6e63',
            messageBoard: '0x716CfE1272Ed90A33050af469A83852bE2Ff9260',
            counter: '0x4e42F24592c5F44D8B7E550253A21d14EFF69d29',
            storageunit: '0x02FB8E219ac0E544B4E107Ab8B89a4Ce335F2A05',
            randompicker: '0xA178dF985feAa35c60DCEe330dD0F5F5a26eE1Ea',
            greetingcard: '0x95178C466682ae7482AFeF6c9A32e95C826c4Ecd',
            tokentracker: '0xA54E4190e9579055dF42B4DD5c2a92F9A2A7903e',
            eventTracker: '0x176036Ec2525208FD1c219d85D440B394Dc939ec',
            priceChecker: '0x3eD3151Ea8B0D7D210feB46d4880E352bC77E97b',
            todoList: '0xF047e5B232e87386b114AeEDcF0AEfB8090e064f',
            scoreboard: '0xdb1A13153F2441e9E220cb88162160DC889DA33b',
            feedbackBox: '0x106520CcBf8C35df8B6D0c3ab850Bfd39544Aa56',
            wishList: '0x8a5E1BC983B249c7D7a8f8624e53D613e02fA825',
            quizGame: '0xd87022114a708067Dec44ae96E46D13a66815420',
            donationPool: '0x9FEa4f273da54A5Ed9dC2E95eb5940B59049f3a6',
            profileBadge: '0x38E160E83F7fe08fc33CcEB395f7E1bA490B3D66',
            pollResultsViewer: '0xeA162AfCbB6ee15b985531756661DA0cf6d8e993',
            eventReminder: '0x1a96bDbaA512Eb6aEE08D589e1eAb1D9193484Ca',
            feedbackCollector: '0xfE4926D33Ab79E327818615E95EfB71390296BEc',
            rewardTracker: '0x5dCF245485A2cbc17038220e60AE0268879dB470',
            eventLogger: '0xFac50ce5cdb4E93608A5032b9c3Ca60bA3a8D5d5'
        };
        const abis = {
            simpleTimer: [{"inputs":[],"name":"resetTimer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"duration","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"endTime","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTimeLeft","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            tipJar: [{"inputs":[],"name":"tip","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalTips","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}],
            votePoll: [{"inputs":[{"internalType":"bool","name":"_yes","type":"bool"}],"name":"vote","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getResults","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            giveawayBox: [{"inputs":[],"name":"addFunds","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"claim","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"claimAmount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"hasClaimed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"}],
            messageBoard: [{"inputs":[{"internalType":"string","name":"_message","type":"string"}],"name":"setMessage","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getMessage","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            counter: [{"inputs":[],"name":"increment","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            storageunit: [{"inputs":[{"internalType":"string","name":"_data","type":"string"}],"name":"store","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getData","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            randompicker: [{"inputs":[],"name":"pickRandom","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            greetingcard: [{"inputs":[{"internalType":"string","name":"_greeting","type":"string"}],"name":"sendGreeting","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"getGreeting","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            tokentracker: [{"inputs":[{"internalType":"address","name":"_token","type":"address"}],"name":"trackToken","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            eventTracker: [{"inputs":[{"internalType":"uint256","name":"_eventId","type":"uint256"}],"name":"trackEvent","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"getEvent","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            priceChecker: [{"inputs":[],"name":"checkPrice","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            todoList: [{"inputs":[{"internalType":"string","name":"_task","type":"string"}],"name":"addTask","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"getTask","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            scoreboard: [{"inputs":[],"name":"addScore","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getScore","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            feedbackBox: [{"inputs":[{"internalType":"string","name":"_feedback","type":"string"}],"name":"sendFeedback","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"getFeedback","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            wishList: [{"inputs":[{"internalType":"string","name":"_wish","type":"string"}],"name":"addWish","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"}],"name":"getWish","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            quizGame: [{"inputs":[{"internalType":"bool","name":"_answer","type":"bool"}],"name":"submitAnswer","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getScore","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            donationPool: [{"inputs":[],"name":"donate","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"getTotalDonated","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"}],
            profileBadge: [{"inputs":[],"name":"claimBadge","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getBadgeStatus","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"}],
            pollResultsViewer: [{"inputs":[{"internalType":"uint256","name":"_pollId","type":"uint256"}],"name":"updateResults","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pollId","type":"uint256"}],"name":"getTotalVotes","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            eventReminder: [{"inputs":[{"internalType":"uint256","name":"_eventId","type":"uint256"}],"name":"setReminder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_eventId","type":"uint256"}],"name":"getEvent","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            feedbackCollector: [{"inputs":[{"internalType":"string","name":"_feedback","type":"string"}],"name":"submitFeedback","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getFeedbackCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_index","type":"uint256"}],"name":"getFeedback","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"}],
            rewardTracker: [{"inputs":[{"internalType":"address","name":"_user","type":"address"},{"internalType":"uint256","name":"_amount","type":"uint256"}],"name":"addReward","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_user","type":"address"}],"name":"getReward","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}],
            eventLogger: [{"inputs":[{"internalType":"string","name":"_log","type":"string"}],"name":"recordLog","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"getLogCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}]
        };

        let accounts;

        async function checkNetwork() {
            if (window.ethereum) {
                while (true) {
                    const chainId = await web3.eth.getChainId();
                    if (chainId === 8453) break;
                    alert("Please switch to Base Mainnet in MetaMask!");
                    await new Promise(resolve => setTimeout(resolve, 1000)); // Wait 1s before retry
                }
            }
        }

        async function init() {
            if (!window.ethereum) {
                document.getElementById("status").innerText = "Please install MetaMask!";
                return;
            }
            try {
                await checkNetwork();
                accounts = await web3.eth.getAccounts();
                if (accounts.length === 0) {
                    await window.ethereum.request({ method: 'eth_requestAccounts' });
                    accounts = await web3.eth.getAccounts();
                }
                updateAll();
            } catch (error) {
                document.getElementById("status").innerText = "Wallet connection failed: " + error.message;
            }
        }

        async function resetTimer() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Resetting...";
            try {
                const contract = new web3.eth.Contract(abis.simpleTimer, addresses.simpleTimer);
                const gasEstimate = await contract.methods.resetTimer().estimateGas({ from: accounts[0] });
                const tx = await contract.methods.resetTimer().send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Reset! Tx: " + tx.transactionHash + ". Updating...";
                updateTimerStatus();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function tip() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Tipping...";
            try {
                const contract = new web3.eth.Contract(abis.tipJar, addresses.tipJar);
                const gasEstimate = await contract.methods.tip().estimateGas({ from: accounts[0] });
                const tx = await contract.methods.tip().send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Tipped! Tx: " + tx.transactionHash + ". Updating...";
                updateTip();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function votePoll() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Voting...";
            try {
                const contract = new web3.eth.Contract(abis.votePoll, addresses.votePoll);
                const vote = document.getElementById("voteOption").value === "true";
                const gasEstimate = await contract.methods.vote(vote).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.vote(vote).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Voted! Tx: " + tx.transactionHash + ". Updating...";
                updatePollResults();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function claimGiveaway() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Claiming...";
            try {
                const contract = new web3.eth.Contract(abis.giveawayBox, addresses.giveawayBox);
                const gasEstimate = await contract.methods.claim().estimateGas({ from: accounts[0] });
                const tx = await contract.methods.claim().send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Claimed! Tx: " + tx.transactionHash + ". Updating...";
                updateClaimAmount();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function setMessage() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Setting...";
            try {
                const contract = new web3.eth.Contract(abis.messageBoard, addresses.messageBoard);
                const message = document.getElementById("messageInput").value;
                const gasEstimate = await contract.methods.setMessage(message).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.setMessage(message).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Set! Tx: " + tx.transactionHash + ". Updating...";
                updateLastMessage();
                document.getElementById("messageInput").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function incrementCounter() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Incrementing...";
            try {
                const contract = new web3.eth.Contract(abis.counter, addresses.counter);
                const gasEstimate = await contract.methods.increment().estimateGas({ from: accounts[0] });
                const tx = await contract.methods.increment().send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Incremented! Tx: " + tx.transactionHash + ". Updating...";
                updateCounterValue();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function storeData() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Storing...";
            try {
                const contract = new web3.eth.Contract(abis.storageunit, addresses.storageunit);
                const data = document.getElementById("storeInput").value;
                const gasEstimate = await contract.methods.store(data).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.store(data).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Stored! Tx: " + tx.transactionHash + ". Updating...";
                updateStoredData();
                document.getElementById("storeInput").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function pickRandom() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Picking...";
            try {
                const contract = new web3.eth.Contract(abis.randompicker, addresses.randompicker);
                const value = await contract.methods.pickRandom().call();
                document.getElementById('randomValue').innerText = value;
                status.innerText = "Picked!";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function sendGreeting() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Sending...";
            try {
                const contract = new web3.eth.Contract(abis.greetingcard, addresses.greetingcard);
                const greeting = document.getElementById("greetingInput").value;
                const gasEstimate = await contract.methods.sendGreeting(greeting).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.sendGreeting(greeting).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Sent! Tx: " + tx.transactionHash + ". Updating...";
                updateLastGreeting();
                document.getElementById("greetingInput").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function trackToken() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Tracking...";
            try {
                const contract = new web3.eth.Contract(abis.tokentracker, addresses.tokentracker);
                const tokenAddress = document.getElementById("tokenAddress").value;
                const gasEstimate = await contract.methods.trackToken(tokenAddress).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.trackToken(tokenAddress).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Tracked! Tx: " + tx.transactionHash + ". Updating...";
                updateTokenBalance();
                document.getElementById("tokenAddress").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function trackEvent() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Tracking...";
            try {
                const contract = new web3.eth.Contract(abis.eventTracker, addresses.eventTracker);
                const gasEstimate = await contract.methods.trackEvent(0).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.trackEvent(0).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Tracked! Tx: " + tx.transactionHash + ". Updating...";
                updateLastTrackedEvent();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function checkPrice() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Checking...";
            try {
                const contract = new web3.eth.Contract(abis.priceChecker, addresses.priceChecker);
                const price = await contract.methods.checkPrice().call();
                document.getElementById('currentPrice').innerText = web3.utils.fromWei(price, 'ether');
                status.innerText = "Checked!";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function addTask() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Adding...";
            try {
                const contract = new web3.eth.Contract(abis.todoList, addresses.todoList);
                const task = document.getElementById("todoInput").value;
                const gasEstimate = await contract.methods.addTask(task).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.addTask(task).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Added! Tx: " + tx.transactionHash + ". Updating...";
                updateLastTask();
                document.getElementById("todoInput").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function addScore() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Adding...";
            try {
                const contract = new web3.eth.Contract(abis.scoreboard, addresses.scoreboard);
                const gasEstimate = await contract.methods.addScore().estimateGas({ from: accounts[0] });
                const tx = await contract.methods.addScore().send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Added! Tx: " + tx.transactionHash + ". Updating...";
                updateYourScore();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function sendFeedback() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Sending...";
            try {
                const contract = new web3.eth.Contract(abis.feedbackBox, addresses.feedbackBox);
                const feedback = document.getElementById("feedbackInput").value;
                const gasEstimate = await contract.methods.sendFeedback(feedback).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.sendFeedback(feedback).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Sent! Tx: " + tx.transactionHash + ". Updating...";
                updateLastFeedback();
                document.getElementById("feedbackInput").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function addWish() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Adding...";
            try {
                const contract = new web3.eth.Contract(abis.wishList, addresses.wishList);
                const wish = document.getElementById("wishInput").value;
                const gasEstimate = await contract.methods.addWish(wish).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.addWish(wish).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Added! Tx: " + tx.transactionHash + ". Updating...";
                updateLastWish();
                document.getElementById("wishInput").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function submitAnswer() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Submitting...";
            try {
                const contract = new web3.eth.Contract(abis.quizGame, addresses.quizGame);
                const gasEstimate = await contract.methods.submitAnswer(true).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.submitAnswer(true).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Submitted! Tx: " + tx.transactionHash + ". Updating...";
                updateQuizScore();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function donate() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Donating...";
            try {
                const contract = new web3.eth.Contract(abis.donationPool, addresses.donationPool);
                const gasEstimate = await contract.methods.donate().estimateGas({ from: accounts[0], value: web3.utils.toWei('0.001', 'ether') });
                const tx = await contract.methods.donate().send({ from: accounts[0], value: web3.utils.toWei('0.001', 'ether'), gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Donated! Tx: " + tx.transactionHash + ". Updating...";
                updateTotalDonated();
                document.getElementById('withdrawBtn').disabled = false;
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function withdrawDonation() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Withdrawing...";
            try {
                const contract = new web3.eth.Contract(abis.donationPool, addresses.donationPool);
                const gasEstimate = await contract.methods.withdraw().estimateGas({ from: accounts[0] });
                const tx = await contract.methods.withdraw().send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Withdrawn! Tx: " + tx.transactionHash + ". Updating...";
                updateTotalDonated();
                document.getElementById('withdrawBtn').disabled = true;
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function claimBadge() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Claiming...";
            try {
                const contract = new web3.eth.Contract(abis.profileBadge, addresses.profileBadge);
                const gasEstimate = await contract.methods.claimBadge().estimateGas({ from: accounts[0] });
                const tx = await contract.methods.claimBadge().send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Claimed! Tx: " + tx.transactionHash + ". Updating...";
                updateBadgeStatus();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function updatePollResultsViewer() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Updating...";
            try {
                const contract = new web3.eth.Contract(abis.pollResultsViewer, addresses.pollResultsViewer);
                const gasEstimate = await contract.methods.updateResults(0).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.updateResults(0).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Updated! Tx: " + tx.transactionHash + ". Refreshing...";
                updateTotalVotes();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function setReminder() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Setting...";
            try {
                const contract = new web3.eth.Contract(abis.eventReminder, addresses.eventReminder);
                const gasEstimate = await contract.methods.setReminder(0).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.setReminder(0).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Set! Tx: " + tx.transactionHash + ". Updating...";
                updateLastEvent();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function submitFeedback() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Submitting...";
            try {
                const contract = new web3.eth.Contract(abis.feedbackCollector, addresses.feedbackCollector);
                const feedback = document.getElementById("feedbackInputNew").value;
                const gasEstimate = await contract.methods.submitFeedback(feedback).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.submitFeedback(feedback).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Submitted! Tx: " + tx.transactionHash + ". Updating...";
                updateFeedbackCount();
                document.getElementById("feedbackInputNew").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function addReward() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Adding...";
            try {
                const contract = new web3.eth.Contract(abis.rewardTracker, addresses.rewardTracker);
                const gasEstimate = await contract.methods.addReward(accounts[0], 1).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.addReward(accounts[0], 1).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Added! Tx: " + tx.transactionHash + ". Updating...";
                updateYourReward();
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function recordLog() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            const status = document.getElementById("status");
            status.innerText = "Recording...";
            try {
                const contract = new web3.eth.Contract(abis.eventLogger, addresses.eventLogger);
                const log = document.getElementById("logInput").value;
                const gasEstimate = await contract.methods.recordLog(log).estimateGas({ from: accounts[0] });
                const tx = await contract.methods.recordLog(log).send({ from: accounts[0], gas: Math.floor(gasEstimate * 1.2) });
                status.innerText = "Recorded! Tx: " + tx.transactionHash + ". Updating...";
                updateLogCount();
                document.getElementById("logInput").value = "";
            } catch (error) { status.innerText = "Error: " + error.message; }
        }

        async function updateTimerStatus() {
            const contract = new web3.eth.Contract(abis.simpleTimer, addresses.simpleTimer);
            try {
                const timeLeft = await contract.methods.getTimeLeft().call();
                document.getElementById('timerStatus').innerText = timeLeft > 0 ? timeLeft : "Timer expired";
            } catch (error) {
                document.getElementById('timerStatus').innerText = "Error fetching time";
                console.error("UpdateTimerStatus error:", error);
            }
        }

        async function updateTip() {
            const contract = new web3.eth.Contract(abis.tipJar, addresses.tipJar);
            try {
                const totalTips = await contract.methods.totalTips().call();
                document.getElementById('tipAmount').innerText = totalTips;
            } catch (error) {
                document.getElementById('tipAmount').innerText = "Error fetching tips";
                console.error("UpdateTip error:", error);
            }
        }

        async function updatePollResults() {
            const contract = new web3.eth.Contract(abis.votePoll, addresses.votePoll);
            try {
                const [yes, no] = await contract.methods.getResults().call();
                document.getElementById('yesVotes').innerText = yes;
                document.getElementById('noVotes').innerText = no;
            } catch (error) {
                document.getElementById('yesVotes').innerText = "Error";
                document.getElementById('noVotes').innerText = "Error";
                console.error("UpdatePollResults error:", error);
            }
        }

        async function updateClaimAmount() {
            const contract = new web3.eth.Contract(abis.giveawayBox, addresses.giveawayBox);
            try {
                const amount = await contract.methods.claimAmount().call();
                document.getElementById('claimAmount').innerText = amount;
            } catch (error) {
                document.getElementById('claimAmount').innerText = "Error fetching amount";
                console.error("UpdateClaimAmount error:", error);
            }
        }

        async function updateLastMessage() {
            const contract = new web3.eth.Contract(abis.messageBoard, addresses.messageBoard);
            try {
                const message = await contract.methods.getMessage().call();
                document.getElementById('lastMessage').innerText = message;
            } catch (error) {
                document.getElementById('lastMessage').innerText = "Error fetching message";
                console.error("UpdateLastMessage error:", error);
            }
        }

        async function updateCounterValue() {
            const contract = new web3.eth.Contract(abis.counter, addresses.counter);
            try {
                const count = await contract.methods.getCount().call();
                document.getElementById('counterValue').innerText = count;
            } catch (error) {
                document.getElementById('counterValue').innerText = "Error fetching count";
                console.error("UpdateCounterValue error:", error);
            }
        }

        async function updateStoredData() {
            const contract = new web3.eth.Contract(abis.storageunit, addresses.storageunit);
            try {
                const data = await contract.methods.getData().call();
                document.getElementById('storedData').innerText = data;
            } catch (error) {
                document.getElementById('storedData').innerText = "Error fetching data";
                console.error("UpdateStoredData error:", error);
            }
        }

        async function updateRandomValue() {
            const contract = new web3.eth.Contract(abis.randompicker, addresses.randompicker);
            try {
                const value = await contract.methods.pickRandom().call();
                document.getElementById('randomValue').innerText = value;
            } catch (error) {
                document.getElementById('randomValue').innerText = "Error fetching value";
                console.error("UpdateRandomValue error:", error);
            }
        }

        async function updateLastGreeting() {
            const contract = new web3.eth.Contract(abis.greetingcard, addresses.greetingcard);
            try {
                const greeting = await contract.methods.getGreeting(0).call();
                document.getElementById('lastGreeting').innerText = greeting;
            } catch (error) {
                document.getElementById('lastGreeting').innerText = "Error fetching greeting";
                console.error("UpdateLastGreeting error:", error);
            }
        }

        async function updateTokenBalance() {
            const contract = new web3.eth.Contract(abis.tokentracker, addresses.tokentracker);
            try {
                const balance = await contract.methods.getBalance(accounts[0]).call();
                document.getElementById('tokenBalance').innerText = balance;
            } catch (error) {
                document.getElementById('tokenBalance').innerText = "Error fetching balance";
                console.error("UpdateTokenBalance error:", error);
            }
        }

        async function updateLastTrackedEvent() {
            const contract = new web3.eth.Contract(abis.eventTracker, addresses.eventTracker);
            try {
                const event = await contract.methods.getEvent(0).call();
                document.getElementById('lastTrackedEvent').innerText = event;
            } catch (error) {
                document.getElementById('lastTrackedEvent').innerText = "Error fetching event";
                console.error("UpdateLastTrackedEvent error:", error);
            }
        }

        async function updateCurrentPrice() {
            const contract = new web3.eth.Contract(abis.priceChecker, addresses.priceChecker);
            try {
                const price = await contract.methods.checkPrice().call();
                document.getElementById('currentPrice').innerText = web3.utils.fromWei(price, 'ether');
            } catch (error) {
                document.getElementById('currentPrice').innerText = "Error fetching price";
                console.error("UpdateCurrentPrice error:", error);
            }
        }

        async function updateLastTask() {
            const contract = new web3.eth.Contract(abis.todoList, addresses.todoList);
            try {
                const task = await contract.methods.getTask(0).call();
                document.getElementById('lastTask').innerText = task;
            } catch (error) {
                document.getElementById('lastTask').innerText = "Error fetching task";
                console.error("UpdateLastTask error:", error);
            }
        }

        async function updateYourScore() {
            const contract = new web3.eth.Contract(abis.scoreboard, addresses.scoreboard);
            try {
                const score = await contract.methods.getScore(accounts[0]).call();
                document.getElementById('yourScore').innerText = score;
            } catch (error) {
                document.getElementById('yourScore').innerText = "Error fetching score";
                console.error("UpdateYourScore error:", error);
            }
        }

        async function updateLastFeedback() {
            const contract = new web3.eth.Contract(abis.feedbackBox, addresses.feedbackBox);
            try {
                const feedback = await contract.methods.getFeedback(0).call();
                document.getElementById('lastFeedback').innerText = feedback;
            } catch (error) {
                document.getElementById('lastFeedback').innerText = "Error fetching feedback";
                console.error("UpdateLastFeedback error:", error);
            }
        }

        async function updateLastWish() {
            const contract = new web3.eth.Contract(abis.wishList, addresses.wishList);
            try {
                const wish = await contract.methods.getWish(0).call();
                document.getElementById('lastWish').innerText = wish;
            } catch (error) {
                document.getElementById('lastWish').innerText = "Error fetching wish";
                console.error("UpdateLastWish error:", error);
            }
        }

        async function updateQuizScore() {
            const contract = new web3.eth.Contract(abis.quizGame, addresses.quizGame);
            try {
                const score = await contract.methods.getScore(accounts[0]).call();
                document.getElementById('quizScore').innerText = score;
            } catch (error) {
                document.getElementById('quizScore').innerText = "Error fetching score";
                console.error("UpdateQuizScore error:", error);
            }
        }

        async function updateTotalDonated() {
            const contract = new web3.eth.Contract(abis.donationPool, addresses.donationPool);
            try {
                const total = await contract.methods.getTotalDonated().call();
                document.getElementById('totalDonated').innerText = total;
            } catch (error) {
                document.getElementById('totalDonated').innerText = "Error fetching total";
                console.error("UpdateTotalDonated error:", error);
            }
        }

        async function updateBadgeStatus() {
            const contract = new web3.eth.Contract(abis.profileBadge, addresses.profileBadge);
            try {
                const status = await contract.methods.getBadgeStatus(accounts[0]).call();
                document.getElementById('badgeStatus').innerText = status ? "Claimed" : "Not Claimed";
            } catch (error) {
                document.getElementById('badgeStatus').innerText = "Error fetching status";
                console.error("UpdateBadgeStatus error:", error);
            }
        }

        async function updateTotalVotes() {
            const contract = new web3.eth.Contract(abis.pollResultsViewer, addresses.pollResultsViewer);
            try {
                const total = await contract.methods.getTotalVotes(0).call();
                document.getElementById('totalVotes').innerText = total;
            } catch (error) {
                document.getElementById('totalVotes').innerText = "Error fetching votes";
                console.error("UpdateTotalVotes error:", error);
            }
        }

        async function updateLastEvent() {
            const contract = new web3.eth.Contract(abis.eventReminder, addresses.eventReminder);
            try {
                const event = await contract.methods.getEvent(0).call();
                document.getElementById('lastEvent').innerText = event;
            } catch (error) {
                document.getElementById('lastEvent').innerText = "Error fetching event";
                console.error("UpdateLastEvent error:", error);
            }
        }

        async function updateFeedbackCount() {
            const contract = new web3.eth.Contract(abis.feedbackCollector, addresses.feedbackCollector);
            try {
                const count = await contract.methods.getFeedbackCount().call();
                document.getElementById('feedbackCount').innerText = count;
            } catch (error) {
                document.getElementById('feedbackCount').innerText = "Error fetching count";
                console.error("UpdateFeedbackCount error:", error);
            }
        }

        async function updateYourReward() {
            const contract = new web3.eth.Contract(abis.rewardTracker, addresses.rewardTracker);
            try {
                const reward = await contract.methods.getReward(accounts[0]).call();
                document.getElementById('yourReward').innerText = reward;
            } catch (error) {
                document.getElementById('yourReward').innerText = "Error fetching reward";
                console.error("UpdateYourReward error:", error);
            }
        }

        async function updateLogCount() {
            const contract = new web3.eth.Contract(abis.eventLogger, addresses.eventLogger);
            try {
                const count = await contract.methods.getLogCount().call();
                document.getElementById('logCount').innerText = count;
            } catch (error) {
                document.getElementById('logCount').innerText = "Error fetching count";
                console.error("UpdateLogCount error:", error);
            }
        }

        async function updateAll() {
            if (!accounts || accounts.length === 0) {
                document.getElementById("status").innerText = "Please connect MetaMask!";
                return;
            }
            await Promise.all([
                updateTimerStatus(), updateTip(), updatePollResults(), updateClaimAmount(),
                updateLastMessage(), updateCounterValue(), updateStoredData(), updateRandomValue(),
                updateLastGreeting(), updateTokenBalance(), updateLastTrackedEvent(), updateCurrentPrice(),
                updateLastTask(), updateYourScore(), updateLastFeedback(), updateLastWish(),
                updateQuizScore(), updateTotalDonated(), updateBadgeStatus(), updateTotalVotes(),
                updateLastEvent(), updateFeedbackCount(), updateYourReward(), updateLogCount()
            ]);
        }

        window.addEventListener('load', init);
    </script>
</body>
</html>
